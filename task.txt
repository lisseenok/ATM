Задача
Надо моделировать работу банкомата следующей конструкции. Банкомат состоит из следующих элементов:
• пульт управления;
• устройство идентификации банковской карты (номер карты + пин код);
• устройство приема денег;
• устройство выдачи денег.
• устройство отображения состояния банкомата и состояния выполняемой операции;
Кнопки пульта управления:
• цифровая клавиатура;
• кнопки выполнения операции
• кнопка завершения операции.
Правила работы с банкоматом.
Банкомат готовиться к работе следующим образом:
1. загружается информация относительно зарегистрированных карт и имеющих на них средств.
2. загружается заданное количество купюр для выдачи денег.
3. выводится сообщение о готовности банкомата к работе.
После готовности банкомата выполняются действия:
• приложить карту к устройству идентификации;
• распознавание карты;
• запрос, ввод и подтверждение ПИН-кода;
• выбор команды;
• вносить можно купюры кратные 100 р.
• при внесении денег осуществляется суммирование;
• если для снятия запрошенного количества денег средств на карте или в банкомате недостаточно, сообщается о недостаточности средств.
Вносить можно купюры с достоинством 5000, 2000, 1000, 500 и 100 рублей в неограниченном количестве.
При снятии денег выдаются купюры с достоинством 5000, 2000, 1000, 500 и 100 рублей. Снятие денег осуществляется в режиме «Выдать крупными».
Идентификация карты, нажатия на кнопки пульта управления, внесение или снятие денег моделируется посредством клавиатурного ввода. Ввод делится на команды и их восприятие зависит от состояния банкомата последовательности выдачи. Шаблоны команд:
Identification «номер карты»
Команда выдается при состоянии банкомата «Готов к работе». Номер карты задается четырьмя группами из 4 цифр: xxxx xxxx xxxx xxxx
PIN-code «четыре цифры»
Команда может быть выдана только после подтверждения корректности номера карты и запроса «Enter the PIN code»
Deposit money «значение купюры»
Команды могут быть выданы последовательно, тогда их значения суммируются и выдается сообщение:
The amount: «введенная сумма»
«значение купюры» может равняться 5000, 2000, 1000, 500, 100. Купюры других достоинств не принимаются. После этих команд надо ввести команду подтверждения
Deposit money to the card
После выдается сообщение:
Card balance «сумма на карте»
Если введена другая команда, то банкомат внесенные купюры возвращает.
Withdraw money «сумма»
По данной команде выдаются деньги в режиме «Выдать крупными». «сумма» должна быть кратна 100. Если денег на карте достаточно и купюр в банкомате тоже, деньги выдаются согласно сообщению:
Take the money: 5000 * «количество купюр» rub., 2000 * «количество купюр» rub., 1000 * «количество купюр» rub., 500 * «количество купюр» rub., 100 * «количество купюр» rub.
Противном случает выдается сообщение:
The amount is not a multiple of 100
Если запрошенная сумма не кратна 100.
There is not enough money on the card
Если на карте недостаточно средств.
There is not enough money in the ATM
Если в банкомате недостаточно средств или из наличных купюр нельзя собрать запрошенную сумму.
End the session
Команда завершения сеанса. Последняя не завершенная команда отменяется и банкомат переходит в состоянии готовности. Выдается сообщение Ready to work
Turn off the ATM
Команда выключения банкомата. Последняя не завершенная команда отменяется и банкомат выключается. Эта команда всегда присутствует.

Отображение текста состояния банкомата и результата операции моделируется посредством вывода на консоли.

Построить систему, которая использует объекты:
1. Объект «система».
2. Объект для чтения команд и данных. Считывает данные для подготовки и настройки банкомата. После чтения очередной порции данных для настройки или данных команды, объект выдает сигнал с текстом полученных данных. Все данные настройки и данные команды синтаксический корректны.
3. Объект пульта управления, для отработки нажатия кнопок (команд). Объект после нажатия кнопки анализирует возможность его выполнения и выдает соответствующий сигнал. Выдает сигнал если запрошенная для снятия сумма не кратна 100 или на карте нет достаточных средств.
4. Объект, моделирующий устройства идентификации банковской карты. Выдает сигнал, содержащий текст результата идентификации.
5. Объект, моделирующий устройства приема денег. После принятия очередной купюры сохраняет его. При внесении денег подряд производит суммирование. Выдает сигнал, содержащий сумму введенных денег для отображения на экран.
6. Объект, моделирующий устройства выдачи денег. Выдает сигнал, содержащий количество купюр возвращаемой суммы или информацию о невозможности получить необходимый состав купюр.
7. Объект для вывода состояния или результата операции банкомата на консоль.

Написать программу, реализующую следующий алгоритм:
1. Вызов метода объекта «система» build_tree_objects ( ).
   1.1. Построение дерева иерархии объектов.
   1.2. Установка связей сигналов и обработчиков между объектами.
2. Вызов метода объекта «система» exec_app ( ).
   2.1. Приведение всех объектов в состояние готовности.
   2.2. Цикл для обработки вводимых данных для загрузки банкомата.
        2.2.1. Выдача сигнала объекту для ввода данных.
        2.2.2. Отработка операции загрузки.
   2.3. Цикл для обработки вводимых команд банкомата.
        2.3.1. Выдача сигнала объекту для ввода команды.
        2.3.2. Отработка команды.
2.4. После ввода команды «Turn off the ATM» завершить работу.

Все приведенные сигналы и соответствующие обработчики должны быть реализованы.
Все сообщения на консоль выводятся с новой строки.
В набор поддерживаемых команд добавить команду «SHOWTREE» и по этой команде вывести дерево иерархии объектов системы с отметкой о готовности и завершить работу программы.

При решении задачи необходимо руководствоваться методическим пособием и приложением к методическому пособию

Входные данные
Ввод информации о картах по последовательности первых строк
номер карты ПИН-код сумма на карте
Ввод информации о картах завершается строкой
End card loading
Следующая строка содержит количество загружаемых купюр разного достоинства в последовательности: 5000, 2000, 1000, 500 и 100 рублевых.
количество купюр количество купюр количество купюр количество купюр количество купюр
Далее следуют команды.
Последней командой является
Turn off the ATM



Пример ввода:
1001 2022 0021 0001 5001 15000
1001 2022 0021 0002 5002 25000
1001 2022 0021 0003 5003 35000
1001 2022 0021 0004 5004 45000
1001 2022 0021 0005 5005 55000
End card loading
5000 2000 1000 500 100
End money loading
Deposit money 1000
Identification 1001 2022 0021 0004
PIN-code 5004
Deposit money 1000
Deposit money 1000
Deposit money 50
Deposit money to the card
Withdraw money 10000
Deposit money 1000
Deposit money to the card
End the session
Identification 1001 2022 0021 0003
Deposit money 1000
Deposit money to the card
End the session
Deposit money 1000
Identification 1001 2022 0021 0001
PIN-code 5001
Withdraw money 8500
Deposit money 1500
Deposit money 500
Deposit money to the card
End the session
Turn off the ATM

Выходные данные
Шаблоны текстов, которые отображаются на консоли:
Готов к работе, отображается в начале работы системы, после завершения загрузки банкомата. Также отображается после завершения сеанса работы. Банкомат готов для обслуживания нового клиента т.е. идентификации карты. Другая команда игнорируется.
Ready to work
После идентификации карты выдается сообщение
Select the command
Сообщение о величине внесенной суммы после ввода очередной купюры.
The amount: сумма денег
Сообщение для получения денег:
Take the money: 5000 * количество купюр rub., 2000 * количество купюр rub., 1000 * количество купюр rub., 500 * количество купюр rub., 100 * количество купюр rub.
Сообщение баланса карты
Card balance сумма на карте
Сообщение завершения работы банкомата:
Turn off the ATM



Пример вывода
Ready to work
Ready to work
Enter the PIN code
Select the command
The amount: 1000
The amount: 2000
Card balance 47000
Take the money: 5000 * 2 rub., 2000 * 0 rub., 1000 * 0 rub., 500 * 0 rub.,  100 * 0 rub.
The amount: 1000
Card balance 38000
Ready to work
Enter the PIN code
Ready to work
Ready to work
Ready to work
Ready to work
Enter the PIN code
Select the command
Take the money: 5000 * 1 rub., 2000 * 1 rub., 1000 * 1 rub., 500 * 1 rub.,  100 * 0 rub.
The amount: 500
Card balance 7000
Ready to work
Turn off the ATM